<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="utf-8" />
    <title>WebGISå¼€å‘-å´é™¶ç„¶</title>
    
    <!-- Force HTTP protocol to avoid HTTPS certificate issues with Baidu Maps -->
    <script>
        // Redirect to HTTP if accessed via HTTPS
        if (window.location.protocol === 'https:') {
            window.location.href = 'http://' + window.location.host + window.location.pathname + window.location.search + window.location.hash;
        }
    </script>

    <link rel="shortcut icon" href="map.ico">
    <link rel="stylesheet" type="text/css" href="resources/css/style_.css">
    <link rel="stylesheet" href="resources/css/popup.css">
   
    <link rel="stylesheet" href="resources/css/settings.css">
    <link rel="stylesheet" href="resources/css/markers.css">
    <link rel="stylesheet" href="resources/css/layout.css">
    <link rel="stylesheet" href="resources/css/map.css">
    <!-- OpenLayers CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ol@7.4.0/ol.css">
    <!-- Proj4js for coordinate transformations -->
    <script src="https://cdn.jsdelivr.net/npm/proj4@2.9.0/dist/proj4.js"></script>
    <!-- OpenLayers JS -->
    <script src="https://cdn.jsdelivr.net/npm/ol@7.4.0/dist/ol.js"></script>
    <!-- Shapefile.js for client-side shapefile parsing -->
    <script src="https://cdn.jsdelivr.net/npm/shapefile@0.6.6/dist/shapefile.min.js"></script>
    <!-- JSZip for extracting ZIP files -->
    <script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>
</head>

<body>
    <div class="top-header">
        <div>GISå¼€å‘</div>
        <div class="top-header-actions">
            <!-- æœç´¢æ¡† -->
            <div class="search-container">
                <input type="text" id="searchInput" class="search-input" placeholder="æœç´¢åœ°ç‚¹ï¼ˆå¦‚ï¼šåŒ—äº¬å¤©å®‰é—¨ï¼‰..." 
                       onkeypress="if(event.key === 'Enter') { handleSearch(); }">
                <button onclick="handleSearch()" class="search-button" title="æœç´¢">ğŸ”</button>
                <button onclick="clearSearch()" id="clearSearchBtn" class="search-clear-btn" title="æ¸…é™¤">Ã—</button>
            </div>
            <span id="searchStatus" class="search-status">æœç´¢ä¸­...</span>
            <button class="right-button" onclick="showShapefileUploadDialog()" title="ä¸Šä¼ æœ¬åœ° Shapefile">ä¸Šä¼  SHP</button>
            <button class="right-button" onclick="toggleAddMarkerMode()" id="addMarkerBtn">æ·»åŠ æ ‡æ³¨</button>
            <button class="right-button" onclick="showSpatialAnalysisDialog()" title="ç©ºé—´å¥æ³•åˆ†æ">ç©ºé—´åˆ†æ</button>
            <button class="right-button" onclick="Settting()">è®¾ç½®</button>
        </div>
    </div>

    <div id="mapFrame">
        <div id="container"></div>
        <div id="loading">åœ°å›¾åŠ è½½ä¸­...</div>
    </div>

    <div class="bottom-actions">
        <!-- <button onclick="showMap()" class="action-button">æ˜¾ç¤ºåœ°å›¾</button> -->
        <button onclick="showAbout()" class="action-button">å…³äº</button>
        <button onclick="showShapefileUploadDialog()" class="action-button">ä¸Šä¼  Shapefile</button>
        <button onclick="loadMarkersFromDatabase()" class="action-button">åˆ·æ–°æ ‡æ³¨</button>
        <button onclick="showSpatialAnalysisDialog()" class="action-button">ç©ºé—´åˆ†æ</button>
        <button onclick="clearSpatialAnalysis()" class="action-button">æ¸…é™¤åˆ†æ</button>
        <button onclick="location.href='../'" class="action-button">è¿”å›ä¸»ç•Œé¢</button>
        <button onclick="location.href='../MarkDown/index.php'" class="action-button">å¸®åŠ©æ–‡æ¡£</button>
    </div>

    <!-- JavaScript æ–‡ä»¶ - æŒ‰ä¾èµ–é¡ºåºåŠ è½½ -->
    <script src="resources/js/config.js"></script>
    <script src="resources/js/utils.js"></script>
    <script src="resources/js/coordinate-utils.js"></script>
    <script src="resources/js/map-core.js"></script>
    <script src="resources/js/wms-layers.js"></script>
    <script src="resources/js/geoserver.js"></script>
    <script src="resources/js/markers.js"></script>
    <script src="resources/js/settings.js"></script>
    <script src="resources/js/search.js"></script>
    <!-- WASM åŠ é€Ÿæ¨¡å—ï¼ˆå¯é€‰ï¼Œå¦‚æœä¸å¯ç”¨ä¼šè‡ªåŠ¨å›é€€åˆ° JS å®ç°ï¼‰ -->
    <script src="resources/wasm/spatial_analysis.js"></script>
    <script src="resources/js/wasm-loader.js"></script>
    <script src="resources/js/wasm-integration.js"></script>
    <!-- æœ¬åœ° Shapefile åŠ è½½æ¨¡å— -->
    <script src="resources/js/segment-splitter.js"></script>
    <script src="resources/js/shapefile-loader.js"></script>
    <script src="resources/js/local-analysis.js"></script>
    <!-- ç©ºé—´åˆ†æç®—æ³•æ¨¡å—ï¼ˆå¿…é¡»åœ¨ spacial_analyse.js ä¹‹å‰åŠ è½½ï¼‰ -->
    <script src="resources/js/integration.js"></script>
    <script src="resources/js/connection.js"></script>
    <script src="resources/js/spacial_analyse.js"></script>
    <script src="resources/js/main.js"></script>
</body>

</html>
